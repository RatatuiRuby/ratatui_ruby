<!--
SPDX-FileCopyrightText: 2025 Kerrick Long <me@kerricklong.com>
SPDX-License-Identifier: CC-BY-SA-4.0
-->

# Prompt for Developer Agent: Phase 4, Step 4.2

You are a Senior Ruby Developer. Your task is to refactor the existing `examples/hit_test.rb` example to use the new Frame-based API. This implements **Phase 4, Step 4.2** of the [Frame Migration Plan](../../../doc/contributors/frame_migration.md).

## Context

Previous agents have completed:
- **Phase 1**: Rust backend for `RubyFrame` with `area()` and `render_widget()`.
- **Phase 2**: Ruby `Frame` class, updated `RatatuiRuby.draw` signature.
- **Phase 3**: Verified `Layout.split` returns `Array<Rect>`.
- **Phase 4, Step 4.1**: Created `examples/frame_demo` showcasing the new API.

The existing `examples/hit_test` example likely uses a manual `calculate_layout` method to compute rects for hit-testing, duplicating the layout logic used during rendering. Your job is to **refactor** it to use the Frame API, eliminating this duplication.

## Task Specs

### 1. Refactor `examples/hit_test/app.rb`

**Goal**: Remove the duplicated layout calculation by using the Frame API.

**Before (likely pattern)**:
- A `calculate_layout` method that manually computes rects.
- `RatatuiRuby.draw(tree)` that implicitly computes layout.
- Hit-testing uses rects from `calculate_layout`.

**After (target pattern)**:
- Use `RatatuiRuby.draw do |frame| ... end`.
- Use `Layout.split(frame.area, ...)` inside the block.
- Store the returned rects in instance variables for hit-testing.
- Delete the `calculate_layout` method (or any equivalent duplication).

### 2. Key Changes

- Replace `RatatuiRuby.draw(tree)` with `RatatuiRuby.draw { |frame| ... }`.
- Replace layout tree construction with explicit `Layout.split` + `frame.render_widget` calls.
- Use the same rects from `Layout.split` for both rendering and hit-testing.
- Ensure all hit-testing logic (e.g., `rect.contains?(x, y)`) still works correctly.

### 3. Update Tests

**File**: `examples/hit_test/test_app.rb` (if it exists)

- Update tests to reflect any API changes.
- Verify hit-testing still works with injected mouse events.

## References
- `examples/hit_test/app.rb`: Current implementation to refactor.
- `examples/frame_demo/app.rb`: New example using the Frame API (created in Step 4.1).
- `doc/contributors/frame_proposal.md`: See usage patterns in "Example: Complete App".
- `doc/contributors/frame_migration.md`: Step 4.2 requirements.

## Definition of Done
- `examples/hit_test/app.rb` uses the new Frame-based API exclusively.
- No duplicated layout calculation logic exists (no separate `calculate_layout` method).
- Rects used for hit-testing come directly from `Layout.split` inside the draw block.
- The example runs successfully and hit-testing still works.
- Tests pass (if present).
